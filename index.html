<!doctype html>
<html lang="ru" class="preloader-active">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Critical CSS Inline -->
    <style>
        #preloader-site-full {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--black);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 1;
            visibility: visible;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        #preloader-site-full.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .loader-site {
            width: 48px;
            height: 48px;
            border: 4px solid rgba(145, 21, 234, 0.3);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        #preloader-site-full p {
            font-size: 1rem;
            color: var(--gray);
            letter-spacing: 1px;
        }
    </style>

    <!-- SEO Meta -->
    <title>Смотреть аниме онлайн бесплатно в HD — AniFox</title>
    <meta name="description"
        content="✅ Более 3000 аниме фильмов и сериалов на AniFox. Смотрите онлайн в HD 720/1080, без регистрации и рекламы. Ежедневные обновления, удобный поиск по жанрам и годам.">
    <meta name="keywords"
        content="аниме онлайн, смотреть аниме, аниме бесплатно, аниме 2025, аниме HD, аниме сериалы, аниме фильмы, naruto, attack on titan, demon slayer, death note, one piece, сёнэн, сёдзё, исекай, романтика, боевик, драма, тетрадь смерти, аниме каталог, аниме поиск">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:locale" content="ru_RU">
    <meta property="og:url" content="https://anifox-search.vercel.app/">
    <meta property="og:title" content="AniFox — смотреть аниме онлайн в HD">
    <meta property="og:description"
        content="Большая база аниме: тысячи сериалов и фильмов в HD. Без регистрации, адаптировано под телефон и Smart-TV.">
    <meta property="og:image" content="https://anifox-search.vercel.app/resources/obl_web.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="AniFox">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="AniFox — смотреть аниме онлайн">
    <meta name="twitter:description" content="Без рекламы, HD 1080, ежедневные обновления.">
    <meta name="twitter:image" content="https://anifox-search.vercel.app/resources/obl_web.jpg">

    <!-- Favicons -->
    <link rel="icon" href="/favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">

    <!-- PWA -->
    <meta name="theme-color" content="#5b0a99">
    <link rel="manifest" href="/manifest.json">

    <!-- Preload critical resources -->
    <link rel="preload" href="/style.css" as="style">
    <link rel="preconnect" href="https://mc.yandex.ru">

    <!-- Non-critical CSS deferred -->
    <link rel="stylesheet" href="/style.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="/cookie-banner.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="/adblock-banner.css" media="print" onload="this.media='all'">
    <noscript>
        <link rel="stylesheet" href="/style.css">
        <link rel="stylesheet" href="/cookie-banner.css">
        <link rel="stylesheet" href="/adblock-banner.css">
    </noscript>

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "AniFox - Смотреть аниме онлайн",
        "url": "https://anifox-search.vercel.app/",
        "description": "Бесплатная платформа для просмотра аниме онлайн в HD качестве.",
        "inLanguage": "ru",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://anifox-search.vercel.app/?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
</head>

<body>

    <!-- Прелоадер - виден сразу благодаря инлайн стилям -->
    <div id="preloader-site-full">
        <div class="loader-site"></div>
    </div>

    <!-- Header -->
    <header class="top">
        <a class="logo-link" href="/" aria-label="AniFox — главная">
            <!-- Оптимизированный SVG -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 265 275" fill="none"
                aria-hidden="true">
                <rect width="40.48" height="283.04" rx="15" transform="matrix(.9066 -.422 .42324 .90602 103.258 17.083)"
                    fill="url(#paint0_linear)" />
                <foreignObject x="-94.47" y="2.529" width="453.94" height="366.95">
                    <div xmlns="http://www.w3.org/1999/xhtml"
                        style="backdrop-filter:blur(50px);clip-path:url(#bgblur_clip);height:100%;width:100%"></div>
                </foreignObject>
                <rect width="40.44" height="283.32" rx="15" transform="matrix(-.5065 -.86224 -.86303 .50515 265 131.88)"
                    fill="url(#paint1_linear)" />
                <rect width="40.48" height="283.04" rx="15" transform="matrix(-.9066 -.422 -.42324 .90602 156.62 17.54)"
                    fill="url(#paint2_linear)" />
                <defs>
                    <clipPath id="bgblur_clip" transform="translate(94.47 -2.529)">
                        <rect width="40.44" height="283.32" rx="15"
                            transform="matrix(-.5065 -.86224 -.86303 .50515 265 131.88)" />
                    </clipPath>
                    <linearGradient id="paint0_linear" x1="20.24" y1="0" x2="27.54" y2="495.89">
                        <stop stop-color="#fff" />
                        <stop offset="1" stop-color="#fff" stop-opacity=".7" />
                    </linearGradient>
                    <linearGradient id="paint1_linear" x1="25.124" y1="411.96" x2="33.264" y2="-4.776">
                        <stop stop-color="#22083f" stop-opacity=".7" />
                        <stop offset="1" stop-color="#6c16c9" />
                    </linearGradient>
                    <linearGradient id="paint2_linear" x1="20.24" y1="0" x2="20.24" y2="283.04">
                        <stop stop-color="#fff" />
                        <stop offset="1" stop-color="#fff" />
                    </linearGradient>
                </defs>
            </svg>
            <span class="logo-text">AniFox</span>
        </a>
    </header>

    <!-- Search Section -->
    <section class="search-section">
        <form id="searchForm" action="/" method="get" autocomplete="off">
            <label class="visually-hidden" for="searchInput">Название аниме</label>
            <input id="searchInput" name="q" type="search" placeholder="Название аниме…" aria-label="Поиск аниме">
            <button type="submit">Найти</button>
        </form>
    </section>

    <!-- Main content -->
    <main id="resultsBox" class="player-lane" aria-live="polite">
        <!-- Content loaded dynamically -->
    </main>

    <!-- Footer -->
    <footer class="site-footer" aria-label="Футер сайта">
        <div class="footer-content">
            <div class="footer-main">
                <div class="footer-section">
                    <h3>AniFox</h3>
                    <p>Лучшая платформа для просмотра аниме онлайн в HD качестве. Бесплатно и без регистрации.</p>
                    <div class="footer-links">
                        <a href="/privacy-policy.html">Политика конфиденциальности</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Разделы</h4>
                    <ul>
                        <li><a href="/">Главная</a></li>
                        <li><a href="/?page=favorites">Избранное</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="footer-copyright">
                    <p>&copy; 2025 AniFox. Весь контент принадлежит правообладателям.</p>
                </div>
                <div class="footer-social">
                    <a href="https://vk.com/anifox_ru" aria-label="ВКонтакте" target="_blank" rel="noopener">
                        <i class="fab fa-vk"></i>
                    </a>
                    <a href="https://t.me/anifoxru" aria-label="Telegram" target="_blank" rel="noopener">
                        <i class="fab fa-telegram"></i>
                    </a>
                    <a href="https://github.com/SerGioPlay01/anifox-search" aria-label="GitHub" target="_blank"
                        rel="noopener">
                        <i class="fab fa-github"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Optimized preloader script -->
    <script>
        // Минимальный прелоадер - запускается мгновенно
        (function () {
            'use strict';

            const preloader = document.getElementById('preloader-site-full');
            if (!preloader) return;

            let resourcesLoaded = false;
            let domReady = false;

            // Проверяем готовность DOM
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', () => {
                    domReady = true;
                    checkHidePreloader();
                });
            } else {
                domReady = true;
            }

            // Отслеживаем только критические ресурсы
            const criticalResources = Array.from(document.querySelectorAll(
                'link[rel="stylesheet"]:not([media="print"]), script[src]:not([async]):not([defer])'
            ));

            let loadedCount = 0;

            function checkHidePreloader() {
                if (domReady && (resourcesLoaded || loadedCount >= criticalResources.length)) {
                    // Минимальная задержка для плавности
                    setTimeout(() => {
                        preloader.classList.add('hidden');
                        document.documentElement.classList.remove('preloader-active');
                    }, 300);
                }
            }

            // Быстрая проверка ресурсов
            criticalResources.forEach(resource => {
                if (resource.tagName === 'LINK' && resource.rel === 'stylesheet') {
                    if (resource.sheet) {
                        loadedCount++;
                    } else {
                        resource.addEventListener('load', () => {
                            loadedCount++;
                            checkHidePreloader();
                        }, { once: true });
                    }
                }
            });

            // Если нет критических ресурсов, скрываем сразу после DOM ready
            if (criticalResources.length === 0) {
                resourcesLoaded = true;
            }

            // Фолбек: скрыть через 3 секунды максимум
            setTimeout(() => {
                if (!preloader.classList.contains('hidden')) {
                    preloader.classList.add('hidden');
                    document.documentElement.classList.remove('preloader-active');
                }
            }, 3000);

            // Запускаем проверку сразу
            checkHidePreloader();
        })();
    </script>

    <!-- Defer non-critical JS -->
    <script src="/api.js" defer></script>
    <script src="/seo.js" defer></script>
    <script src="/cookie-banner.js" defer></script>
    <script src="/adblock-banner.js" defer></script>
    <script src="/sw-register.js" defer></script>

    <!-- Yandex.Metrika (async) -->
    <script defer>
        (function (m, e, t, r, i, k, a) { m[i] = m[i] || function () { (m[i].a = m[i].a || []).push(arguments) }; m[i].l = 1 * new Date(); k = e.createElement(t), a = e.getElementsByTagName(t)[0], k.async = 1, k.src = r, a.parentNode.insertBefore(k, a) })(window, document, 'script', 'https://mc.yandex.ru/metrika/tag.js', 'ym'); ym(104428432, 'init', { clickmap: true, trackLinks: true, accurateTrackBounce: true, webvisor: true });
    </script>
    <noscript><img src="https://mc.yandex.ru/watch/104428432" style="position:absolute;left:-9999px" alt=""></noscript>
</body>

</html>